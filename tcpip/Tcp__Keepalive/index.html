<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tcp__Keepalive (tcpip.Tcp__Keepalive)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">tcpip</a> &#x00BB; Tcp__Keepalive</nav><h1>Module <code>Tcp__Keepalive</code></h1><p>TCP keepalives.</p><p>A TCP implementation may send &quot;keep-alives&quot; (empty TCP ACKs with the sequence number set to one less than the current sequence number for the connection) in order to provoke the peer to respond with an ACK of the current sequence number. If the peer doesn't recognise the connection (e.g. because the connection state has been dropped) then it will return a RST; if the peer (or the network in-between) fails to respond to a configured number of repeated probes then the connection is assumed to be lost.</p></header><dl><dt class="spec type" id="type-action"><a href="#type-action" class="anchor"></a><code><span class="keyword">type</span> action</code> = <code>[ </code><table class="variant"><tr id="type-action.SendProbe" class="anchored"><td class="def constructor"><a href="#type-action.SendProbe" class="anchor"></a><code>| </code><code>`SendProbe</code></td><td class="doc"><p>we should send a keep-alive now</p></td></tr><tr id="type-action.Wait" class="anchored"><td class="def constructor"><a href="#type-action.Wait" class="anchor"></a><code>| </code><code>`Wait <span class="keyword">of</span> Duration.t</code></td><td class="doc"><p>sleep for a given number of nanoseconds</p></td></tr><tr id="type-action.Close" class="anchored"><td class="def constructor"><a href="#type-action.Close" class="anchor"></a><code>| </code><code>`Close</code></td><td class="doc"><p>connection should be closed</p></td></tr></table><code> ]</code></dt><dd><p>An I/O action to perform</p></dd></dl><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> state</code></dt><dd><p>State of a current connection</p></dd></dl><dl><dt class="spec value" id="val-alive"><a href="#val-alive" class="anchor"></a><code><span class="keyword">val</span> alive : <a href="index.html#type-state">state</a></code></dt><dd><p>An alive connection</p></dd></dl><dl><dt class="spec value" id="val-next"><a href="#val-next" class="anchor"></a><code><span class="keyword">val</span> next : <span>configuration:Mirage_protocols.Keepalive.t</span> <span>&#45;&gt;</span> <span>ns:int64</span> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-action">action</a> * <a href="index.html#type-state">state</a></code></dt><dd><p><code>next ~configuration ~ns state</code> returns the action we should take given that we last received a packet <code>ns</code> nanoseconds ago and the new state of the connection</p></dd></dl><div class="spec module" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span class="keyword">module</span> <a href="Make/index.html">Make</a> : <span class="keyword">functor</span> (<a href="Make/index.html#argument-1-T">T</a> : Mirage_time.S) <span>&#45;&gt;</span> <span class="keyword">functor</span> (<a href="Make/index.html#argument-2-Clock">Clock</a> : Mirage_clock.MCLOCK) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>